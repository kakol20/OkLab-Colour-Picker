const ColourPicker=function(){function $($,s){return Math.floor(($+s*width)*4)}var s,e,o,h,i=!1,r="nothing",n=!0,_={chosen:{x:0,y:0},size:{w:50,h:50},pos:{x:70,y:10},drawOther(){rectMode(CORNER),noFill(),stroke(h.p5Color),rect(this.pos.x,this.pos.y,this.size.w,this.size.h);var $,e,o={x:this.pos.x,y:this.pos.y},i={x:o.x+this.size.w,y:o.y+this.size.h};"a"===d.sliderMode?($=map(this.chosen.x,-.32,.2,o.x,i.x),e=map(this.chosen.y,0,1,i.y,o.y)):"b"===d.sliderMode?($=map(this.chosen.x,-.24,.28,o.x,i.x),e=map(this.chosen.y,0,1,i.y,o.y)):($=map(this.chosen.x,-.24,.28,o.x,i.x),e=map(this.chosen.y,-.32,.2,i.y,o.y)),ellipseMode(CENTER),fill(s.p5Color),stroke(h.p5Color),circle($,e,15)},draw(s,e){var o={x:this.pos.x,y:this.pos.y},h={x:o.x+this.size.w,y:o.y+this.size.h};if(s>=o.x&&s<h.x&&e>=o.y&&e<h.y){var i,r,n,_=$(s,e);"a"===d.sliderMode?(r=d.chosen,n=map(s,o.x,h.x,-.32,.2),i=map(e,h.y,o.y,0,1)):"b"===d.sliderMode?(n=d.chosen,r=map(s,o.x,h.x,-.24,.28),i=map(e,h.y,o.y,0,1)):(i=d.chosen,r=map(s,o.x,h.x,-.24,.28),n=map(e,h.y,o.y,-.32,.2));var l=OkLab.OkLabtosRGB(new OkLab(i,r,n));l.isOutsideRGB?pixels[_+3]=128:pixels[_+3]=255,l.clamp(),pixels[_+0]=255*l.red,pixels[_+1]=255*l.green,pixels[_+2]=255*l.blue}}},d={size:{w:50,h:50},pos:{x:10,y:10},sliderMode:"l",chosen:0,chosenPos:0,drawOther(){rectMode(CORNER),noFill(),stroke(h.p5Color),rect(this.pos.x,this.pos.y,this.size.w,this.size.h),ellipseMode(CENTER),fill(s.p5Color),stroke(h.p5Color),circle(35,this.chosenPos,15)},draw(h,i){if(h>=10&&h<60&&i>=10&&i<height-70){var r,n=map(i,height-70,10,0,1),d=0;d="a"===this.sliderMode?s.a:"b"===this.sliderMode?s.b:s.l,d=map(n,0,1,e,o),r="a"===this.sliderMode?new OkLab(_.chosen.y,d,_.chosen.x):"b"===this.sliderMode?new OkLab(_.chosen.y,_.chosen.x,d):new OkLab(d,_.chosen.x,_.chosen.y),r=OkLab.OkLabtosRGB(r);var l=$(h,i);r.clamp(),pixels[l+0]=255*r.red,pixels[l+1]=255*r.green,pixels[l+2]=255*r.blue}}};return{setup(){n=!0,loop(),h=OkLab.sRGBtoOkLab(new sRGB(28/255,28/255,28/255)),h.l*=2,d.size.h=height-80,_.size.w=d.size.h,_.size.h=d.size.h,(s=OkLab.sRGBtoOkLab(new sRGB(0,0,1))).rgbClamp(),console.log(s),d.sliderMode="l","a"===d.sliderMode?(e=-.24,o=.28,d.chosen=s.a,d.chosenPos=map(s.a,e,o,height-70,10),_.chosen.x=s.b,_.chosen.y=s.l):"b"===d.sliderMode?(e=-.32,o=.2,s.b=map(y,height-70,10,e,o),d.chosen=s.b,d.chosenPos=map(s.b,e,o,height-70,10)):(e=0,o=1,d.chosen=s.l,d.chosenPos=map(s.l,e,o,height-70,10),_.chosen.x=s.a,_.chosen.y=s.b)},draw(){n=!1,"a"===d.sliderMode?(d.chosen=s.a,d.chosenPos=map(s.a,e,o,height-70,10),_.chosen.x=s.b,_.chosen.y=s.l):"b"===d.sliderMode?(d.chosen=s.b,d.chosenPos=map(s.b,e,o,height-70,10),_.chosen.x=s.a,_.chosen.y=s.l):(d.chosen=s.l,d.chosenPos=map(s.l,e,o,height-70,10),_.chosen.x=s.a,_.chosen.y=s.b),loadPixels();for(var $=10;$<width-10;$++)for(var i=0;i<height-10;i++)d.draw($,i),_.draw($,i);updatePixels(),d.drawOther(),_.drawOther(),ellipseMode(CORNER),stroke(h.p5Color),fill(s.p5Color),circle(10,height-60,50)},touchStarted(){var $=mouseX,h=mouseY;$>=10&&$<60&&h>=10&&h<=height-70?(i=!0,console.log("Touch inside slider"),r="slider",h=Math.max(Math.min(h,height-70),10),"a"===d.sliderMode?(e=-.24,o=.28,s.a=map(h,height-70,10,e,o)):"b"===d.sliderMode?(e=-.32,o=.2,s.b=map(h,height-70,10,e,o)):(e=0,o=1,s.l=map(h,height-70,10,e,o)),s.rgbClamp()):$>=70&&$<=width-10&&h>=10&&h<=height-70&&(i=!0,console.log("Touch inside box"),r="box",$=Math.max(Math.min($,width-10),10),h=Math.max(Math.min(h,height-70),10),"a"===d.sliderMode?(s.b=map($,70,width-10,-.32,.2),s.l=map(h,height-70,10,0,1)):"b"===d.sliderMode?(s.a=map($,70,width-10,-.24,.28),s.l=map(h,height-70,10,0,1)):(s.a=map($,70,width-10,-.24,.28),s.b=map(h,height-70,10,-.32,.2)),s.rgbClamp())},touchMoved(){var $=mouseX,h=mouseY;i&&("slider"===r?(h=Math.max(Math.min(h,height-70),10),"a"===d.sliderMode?s.a=map(h,height-70,10,e,o):"b"===d.sliderMode?s.b=map(h,height-70,10,e,o):s.l=map(h,height-70,10,e,o),s.rgbClamp()):"box"===r&&($=Math.max(Math.min($,width-10),10),h=Math.max(Math.min(h,height-70),10),"a"===d.sliderMode?(s.b=map($,70,width-10,-.32,.2),s.l=map(h,height-70,10,0,1)):"b"===d.sliderMode?(s.a=map($,70,width-10,-.24,.28),s.l=map(h,height-70,10,0,1)):(s.a=map($,70,width-10,-.24,.28),s.b=map(h,height-70,10,-.32,.2)),s.rgbClamp()))},touchEnded(){i=!1,r="nothing"}}}();